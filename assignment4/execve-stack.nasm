; Filename: execve-stack.nasm
; Author:  Vivek Ramachandran
; Website:  http://securitytube.net
; Training: http://securitytube-training.com
;
; compile with:
; nasm -f elf execve-stack.nasm
; ld -m elf_i386 -s execve-stack.o -o execve-stack
;
; Purpose:

global _start

section .text

_start:

     ; clear eax, push zero to stack
     xor eax, eax
     push eax

     ; instead of ////bin/bash (12 bytes) we can use //bin/sh (8 bytes) and save 4 bytes
     ; PUSH them onto stack

     push 0x68732f2f
     push 0x6e69622f

    ; load registers

     mov ebx, esp

     push eax
     mov edx, esp

     push ebx
     mov ecx, esp

    ; execute execve

     mov al, 11
     int 0x80
